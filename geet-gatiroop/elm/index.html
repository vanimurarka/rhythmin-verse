<!DOCTYPE HTML>
<html>

<head>
  <meta charset="UTF-8">
  <title>GG Elm</title>
  <script type="text/javascript" src="main.js"></script>
  <script type="text/javascript" src="d3.v2.min.js"></script>
  <script type="text/javascript" src="hpv-draw.v8.0.js"></script>
</head>

<body style="background-color: black; color: white;">
  Maapnee <input type="text" id='idMaapnee' value="2122212221222122"><br>
  <textarea id="poem" rows="5" cols="40">ज़िन्दगी के मोड़ पर यह प्यार का नाता हमारा।
राह की वीरानियों को मिल गया आखिर सहारा।

ज्योत्सना सी स्निग्ध सुन्दर, तुम गगन की तारिका सी।
पुष्पिकाओं से सजी, मधुमास की अभिसारिका सी।

रूप की साकार छवि, माधुर्य्य की स्वच्छन्द धारा।
प्यार का नाता हमारा, प्यार का नाता हमारा।

मैं तुम्ही को खोजता हूँ, चाँद की परछाइयों में।
बाट तकता हूँ तुम्हारी, रात की तनहाइयों में।

आज मेरी कामनाओं ने तुम्हे कितना पुकारा।
प्यार का नाता हमारा, प्यार का नाता हमारा।

दूर हो तुम किन्तु फिर भी दीपिका हो ज्योति मेरी।
प्रेरणा हो शक्ति हो तुम, प्रीति की अनुभूति मेरी।

गुनगुना लो प्यार से, यह गीत मेरा है तुम्हारा।
प्यार का नाता हमारा, प्यार का नाता हमारा।</textarea>
  <br>
  <button onclick="callProcessPoem()">Process Poem</button>
  <div id="myapp"></div>
  <div id="right">
    <div id="chart"></div>
  </div>
  <br>
  Base Count <input type="number" min="1" step="1" id='txtBase' value="1" onchange="callBaseChange()">
</body>

<script type="text/javascript">

// Load the Elm Hindi Poem Rhythm Analyis code
var hpra = Elm.Main.init({
	node: document.getElementById('myapp'),
});

// Listen for commands from the `setStorage` port.
// Turn the data to a string and put it in localStorage.
hpra.ports.givePoemRhythm.subscribe(function(hpraResult) {
    console.log(hpraResult);
    // localStorage.setItem('gg-elm-js-interop', JSON.stringify(state));
    let visDiv = document.getElementById("right");
    let axvailableW = visDiv.clientWidth;
    visualize(hpraResult.processedPoem, axvailableW);
});

function callProcessPoem()
{
  poem = document.getElementById('poem').value;
  maapnee = document.getElementById('idMaapnee').value;
  hpra.ports.getPoem.send(JSON.stringify({ poem: poem, poemType: "maatrik", maapnee : maapnee }));
}

function callAdjustMaatraa(li, ci) { 
  hpra.ports.getMaatraaChange.send(JSON.stringify({ lineI: li, charI: ci })); 
}

function callSetComposite(li) {
  hpra.ports.setComposite.send(JSON.stringify(li)); 
}

function callBaseChange() {
  base = parseInt(document.getElementById('txtBase').value)
  hpra.ports.setBase.send(JSON.stringify(base));
}

</script>

</html>
